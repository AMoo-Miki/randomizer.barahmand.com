const form=document.forms[0],result=document.querySelector(".result"),elHeader=result.querySelector(".header"),elContent=result.querySelector(".content"),elements=form.elements,elCount=elements.setCount,elSize=elements.setSize,elMin=elements.setMin,elMax=elements.setMax,elUnique=elements.unique,SetLeastMax=()=>{[].some.call(elements,e=>"number"===e.type&&(!e.value||e.validity.badInput))||(elMax.min=elUnique.checked?elCount.value*elSize.value+1*elMin.value-1:elMin.value)},Generate=()=>{const e=1*elMin.value,t=1*elCount.value,l=1*elSize.value,n=elMax.value-e+1;let r=[];if(elUnique.checked){let a,o=Array.from({length:n},(t,l)=>l+e),i=n,s=n-t*l;for(;i&&(a=Math.floor(Math.random()*i--),[o[i],o[a]]=[o[a],o[i]],!(i<=s)););for(i=0;i<t;i++)r.push(o.slice(s+i*l,l+s+i*l))}else r=Array.from({length:t},t=>Array.from({length:l},t=>Math.floor(Math.random()*n+e)));elements.sorted.checked&&r.forEach(e=>e.sort((e,t)=>e-t)),r.forEach(e=>console.log(e.join(","))),Display(r)},Column=e=>{let t="",l=1,n=26;for(;(e-=l)>=0;l=n,n*=26)t=String.fromCharCode(parseInt(e%n/l)+65)+t;return t},Display=e=>{const t=30+7*Math.max((""+elMin.value).length,(""+elMax.value).length),l=30+7*(""+elSize.value).length;elContent.innerHTML=`<div style="width: ${l}px">${Array.from({length:1*elSize.value},(e,t)=>t+1).join("<br />\r\n")}</div>`+e.map(e=>`<div style="width: ${t}px">${e.join("<br />\r\n")}</div>`).join(""),elHeader.innerHTML=`<div style="width: ${l}px" title="Copy all numbers"></div>`+Array.from({length:1*elCount.value},(e,l)=>`<div style="width: ${t}px" title="Copy this column">${Column(l+1)}</div>`).join(""),result.style.display="block"};form.addEventListener("submit",e=>{e.preventDefault();const t=[].filter.call(elements,e=>"number"===e.type&&!e.required);t.length&&(t.forEach(e=>e.required=!0),SetLeastMax(),!form.checkValidity())||Generate()},!1),form.addEventListener("input",e=>{const t=e.target;"number"===t.type&&(t.required||(t.required=!0),SetLeastMax())},!1),form.addEventListener("change",e=>{const t=e.target;"checkbox"===t.type&&"unique"===t.name&&SetLeastMax()},!1),elHeader.addEventListener("click",e=>{e.preventDefault();const t=e.target;if(t===elHeader)return;const l=[].indexOf.call(elHeader.childNodes,t);if(l<1)return;const n=document.createRange(),r=window.getSelection();r.removeAllRanges(),n.selectNode(elContent.childNodes.item(l)),r.addRange(n)},!1);